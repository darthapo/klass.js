
if(!({}).watch&&({}).__defineGetter__){(function setupWatch(){var _watchCache={_values:{},_objs:{},init:function(obj,key){if(!_watchCache._values[obj])_watchCache._values[obj]={};if(!_watchCache._objs[obj])_watchCache._objs[obj]=0;_watchCache._values[obj][key]=obj[key];_watchCache._objs[obj]+=1;},get:function(obj,key){return _watchCache._values[obj][key];},set:function(obj,key,value){_watchCache._values[obj][key]=value;},remove:function(obj,key){if(_watchCache._values[obj]){delete _watchCache._values[obj][key];_watchCache._objs[obj]-=1;if(_watchCache._objs[obj]==0){delete _watchCache._objs[obj];delete _watchCache._values[obj];}}}};Object.prototype.watch=function(key,callback){if(typeof key!="string")return;if(typeof callback!="function")return;var self=this;_watchCache.init(self,key);this.__defineGetter__(key,function(){return _watchCache.get(self,key);});this.__defineSetter__(key,function(newValue){var oldValue=_watchCache.get(self,key),newValue=newValue,newFromWatch=null,newFromWatch=callback.apply(self,[key,oldValue,newValue]);if(newFromWatch!=oldValue)
_watchCache.set(self,key,newFromWatch);});}
Object.prototype.unwatch=function(key){if(typeof key!="string")return;var oldVal=_watchCache.get(this,key);_watchCache.remove(this,key);delete this[key];this[key]=oldVal;}
Object.clearWatchCache=function(){_watchCache._values={};_watchCache._objs={};}
Object.unwatchAllFor=new Function();Object.unwatchAll=new Function();})();}else{Object.clearWatchCache=new Function();Object.unwatchAllFor=new Function();Object.unwatchAll=new Function();}